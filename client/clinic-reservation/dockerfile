# Use a Node.js base image
FROM node:20-alpine

# Set the working directory in the container
RUN addgroup app && adduser -S -G app app
RUN mkdir /app && chown app:app /app
USER app

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .

# RUN addgroup --system --gid 1001 nodejs
# RUN adduser --system --uid 1001 nextjs

# RUN mkdir .next
# RUN chown nextjs:nodejs .next

# ENV NEXT_PUBLIC_API="http://localhost:8000"

RUN npm run build
EXPOSE 3000
CMD ["npm", "run", "start"]
